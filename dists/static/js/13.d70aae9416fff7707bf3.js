webpackJsonp([13],{"8ZFT":function(e,t){},CKk0:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Xxa5"),n=r.n(a),o=r("exGp"),s=r.n(o),i={data:function(){return{softwareName:[],softwareListoptions:[],typeValue:"",typeOptions:[{value:2,label:"文档"},{value:1,label:"软件"},{value:"",label:"全部"}],uploadAddress:"",PJName:"",rules:{customerName:[{required:!0,message:"请输入客户名称",trigger:["blur","change"]}],useName:[{required:!0,message:"请输入使用人",trigger:["blur","change"]}],useDepartment:[{required:!0,message:"请输入使用部门",trigger:["blur","change"]}],customerAddress:[{required:!0,message:"请输入客户地址",trigger:["blur","change"]}],customerEmail:[{required:!0,message:"请输入客户邮箱",trigger:["blur","change"]}]},startTime:"",endTime:"",passId:"",downdialogVisible:!1,downForm:{user:{id:""},software:{id:""},customerName:"",useName:"",useDepartment:"",customerAddress:"",customerEmail:"",deviceInfo:"",firmwareInfo:"",comment:""},timeValue:"",pagenum:"",total:0,page:1,pageSize:50,options:[],defaultProps:{children:"children",label:"accountTitleName"},addData:"",cprops:{checkStrictly:!0,label:"productName",value:"id",children:"children"},data:[],dialogVisible:!1,changedialogVisible:!1,form:{parentId:"",productName:""},changeform:{id:"",productName:""},projectList:[]}},created:function(){var e=this;this.getSoftwareLists(),this.getProductList(),this.downForm.user.id=+JSON.parse(localStorage.getItem("data")).id,this.$nextTick(function(){e.$refs.treeBox.setCurrentKey(24)})},methods:{getSoftwareLists:function(){var e=this;return s()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.getSoftwareList({page:1,pageSize:1e3});case 2:t.sent;case 4:case"end":return t.stop()}},t,e)}))()},delCurrentProduct:function(e){var t=this;return s()(n.a.mark(function r(){var a;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=1,r.next=4,t.$confirm("亲, 你确认要删除么?","温馨提示",{type:"warning"});case 4:return r.next=6,t.$http.deleteProductList({id:t.passId,software:{id:e.id}});case 6:0==(a=r.sent).code?(t.$message.success("删除成功"),t.getSoftwareList()):t.$message.error(a.message),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(1);case 13:case"end":return r.stop()}},r,t,[[1,10]])}))()},upLoadType:function(){this.getSoftwareList()},addProdcutName:function(){var e=this;return s()(n.a.mark(function t(){var r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.addproductList(e.form);case 2:0==(r=t.sent).code?(e.$refs.form1.resetFields(),e.$message.success("添加成功")):e.$message.error(r.errMsg),e.dialogVisible=!1,e.getProductList();case 7:case"end":return t.stop()}},t,e)}))()},changeProductList:function(){var e=this;return s()(n.a.mark(function t(){var r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.updateProductList(e.changeform);case 2:0==(r=t.sent).code?e.$message.success("修改成功"):e.$message.error(r.message),e.changedialogVisible=!1,e.getProductList();case 6:case"end":return t.stop()}},t,e)}))()},handleChange:function(e){this.form.parentId=null!=e?e[e.length-1]||-1:""},append:function(e){var t=this;return s()(n.a.mark(function r(){return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t.changeform.id=e.id,t.changeform.productName=e.productName,t.changedialogVisible=!0;case 4:case"end":return r.stop()}},r,t)}))()},getProductList:function(){var e=this;return s()(n.a.mark(function t(){var r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.getproductList();case 2:r=t.sent,e.data=r.result,e.options=e.setDisable(2,r.result,2);case 7:case"end":return t.stop()}},t,e)}))()},setDisable:function(e,t,r){var a=this;return e>r?t.forEach(function(e){e.disabled=!0}):t.forEach(function(t){t.count=e,t.children&&t.children.length&&(t.count++,a.setDisable(t.count,t.children,r))}),t},remove:function(e,t){var r=this;return s()(n.a.mark(function a(){var o,s,i,l,c;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=1,a.next=4,r.$confirm("确认要删除么?","温馨提示",{type:"warning"});case 4:return a.next=6,r.$http.deleteProductList({id:t.id});case 6:o=a.sent,0===(s=o.aa).code?r.$message.success("删除成功"):r.$message.error(s.errMsg),a.next=13;break;case 11:a.prev=11,a.t0=a.catch(1);case 13:r.getProductList(),i=e.parent,l=i.data.children||i.data,c=l.findIndex(function(e){return e.id===t.id}),l.splice(c,1);case 18:case"end":return a.stop()}},a,r,[[1,11]])}))()},handleSizeChange:function(e){this.pagesize=e,this.pagenum=1,this.getProjectList()},handleCurrentChange:function(e){this.pagenum=e,this.getProjectList()},handleNodeClick:function(e,t,r){var a=this;return s()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a.passId=e.id,a.getSoftwareList();case 3:case"end":return t.stop()}},t,a)}))()},getSoftwareList:function(){var e=this;return s()(n.a.mark(function t(){var r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.getSoftwareList({id:e.passId,page:e.page,pageSize:e.pageSize,startTime:e.startTime,endTime:e.endTime,name:e.PJName,fileType:e.typeValue});case 2:r=t.sent,e.total=r.result.length,e.projectList=r.result;case 6:case"end":return t.stop()}},t,e)}))()},showDownDialog:function(e){var t=this;return s()(n.a.mark(function r(){var a,o;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t.uploadAddress=e.uploadAddress,t.downForm.software.id=e.id,2!=e.fileType){r.next=11;break}return a=t.$store.state.baseurl,r.next=7,t.$http.recordadd({user:{id:t.downForm.user.id},software:{id:e.id}});case 7:0==(o=r.sent).code?(t.$message.success("正在下载..."),window.location.href=a+t.uploadAddress):t.$message.error(o.message),r.next=12;break;case 11:t.downdialogVisible=!0;case 12:case"end":return r.stop()}},r,t)}))()},downloadProduct:function(){var e=this;this.$refs.downForm.validate(function(t){if(!t)return!1;e.UpdateRecordadd()})},UpdateRecordadd:function(e){var t=this;return s()(n.a.mark(function e(){var r,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.recordadd(t.downForm);case 2:0==(r=e.sent).code?(t.$message.success("保存成功,准备下载"),t.downdialogVisible=!1,a=t.$store.state.baseurl,window.location.href=a+t.uploadAddress,t.getSoftwareList()):t.$message.error(r.message);case 4:case"end":return e.stop()}},e,t)}))()},searchPJName:function(e){this.getSoftwareList()},searchTime:function(e){if(null==e)return this.startTime="",this.endTime="",void this.getSoftwareList();this.startTime=e[0],this.endTime=e[1],this.getSoftwareList()}}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"AccountingItem"},[r("div",[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-button",{staticClass:"addBtn",attrs:{type:"success"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("添加")])],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form",[r("el-form-item",{attrs:{label:" 上传时间:"}},[r("el-date-picker",{staticStyle:{width:"70%"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM",clearable:""},on:{change:e.searchTime},model:{value:e.timeValue,callback:function(t){e.timeValue=t},expression:"timeValue"}})],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form",[r("el-form-item",{attrs:{label:"上传类型"}},[r("el-select",{staticStyle:{width:"70%"},attrs:{placeholder:"请选择"},on:{change:e.upLoadType},model:{value:e.typeValue,callback:function(t){e.typeValue=t},expression:"typeValue"}},e._l(e.typeOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})}),1)],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form",[r("el-form-item",{attrs:{label:"软件名称"}},[r("el-input",{staticStyle:{width:"50%"},nativeOn:{keyup:function(t){return e.searchPJName(t)}},model:{value:e.PJName,callback:function(t){e.PJName=t},expression:"PJName"}})],1)],1)],1)],1)],1),e._v(" "),r("div",{staticClass:"block fl",staticStyle:{width:"20%"}},[r("el-tree",{ref:"treeBox",attrs:{data:e.data,"node-key":"id",props:e.defaultProps,"highlight-current":""},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node,n=t.data;return r("span",{staticClass:"custom-tree-node"},[r("span",{staticClass:"el-icon-notebook-2"},[e._v("  "+e._s(n.productName))]),e._v(" "),r("span",[r("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.append(n)}}},[e._v("   |    修改")]),e._v(" "),r("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.remove(a,n)}}},[e._v("删除")])],1)])}}])})],1),e._v(" "),r("div",{staticClass:"fr ml10"},[r("el-table",{attrs:{data:e.projectList,border:"",size:"mini"}},[r("el-table-column",{attrs:{align:"center",type:"index",label:"序号"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"name",label:"名称"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"version",label:"版本信息"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"user.name",label:"上传人"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"uploadTime",label:"上传时间"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"swProject.projectName",label:"项目名称"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"swProject.comment",label:"描述"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"downloadSize",label:"下载次数"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"swProject.comment",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{plain:"",size:"small",type:"primary",icon:"el-icon-download"},on:{click:function(r){return e.showDownDialog(t.row)}}}),e._v(" "),r("el-button",{attrs:{plain:"",size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(r){return e.delCurrentProduct(t.row)}}})]}}])})],1),e._v(" "),r("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{background:"","current-page":e.page,"page-sizes":[30,50,80],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-dialog",{attrs:{title:"产品线管理",visible:e.dialogVisible,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form1",attrs:{model:e.form,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"名称",prop:"productName"}},[r("el-input",{attrs:{placeholder:"名称"},model:{value:e.form.productName,callback:function(t){e.$set(e.form,"productName",t)},expression:"form.productName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"产品线"}},[r("el-cascader",{staticStyle:{width:"100%"},attrs:{options:e.options,props:e.cprops,clearable:"",placeholder:"请选择(默认为一级分类)"},on:{change:e.handleChange},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.data.productName))])]}}])})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addProdcutName}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"修改",visible:e.changedialogVisible,width:"40%"},on:{"update:visible":function(t){e.changedialogVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.changeform,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"产品名称"}},[r("el-input",{model:{value:e.changeform.productName,callback:function(t){e.$set(e.changeform,"productName",t)},expression:"changeform.productName"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.changedialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.changeProductList}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"下载",visible:e.downdialogVisible,width:"40%"},on:{"update:visible":function(t){e.downdialogVisible=t}}},[r("el-form",{ref:"downForm",attrs:{model:e.downForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"客户名称",prop:"customerName"}},[r("el-input",{model:{value:e.downForm.customerName,callback:function(t){e.$set(e.downForm,"customerName",t)},expression:"downForm.customerName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"使用人",prop:"useName"}},[r("el-input",{model:{value:e.downForm.useName,callback:function(t){e.$set(e.downForm,"useName",t)},expression:"downForm.useName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"使用部门",prop:"useDepartment"}},[r("el-input",{model:{value:e.downForm.useDepartment,callback:function(t){e.$set(e.downForm,"useDepartment",t)},expression:"downForm.useDepartment"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"客户地址",prop:"customerAddress"}},[r("el-input",{model:{value:e.downForm.customerAddress,callback:function(t){e.$set(e.downForm,"customerAddress",t)},expression:"downForm.customerAddress"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"客户邮箱",prop:"customerEmail"}},[r("el-input",{model:{value:e.downForm.customerEmail,callback:function(t){e.$set(e.downForm,"customerEmail",t)},expression:"downForm.customerEmail"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"设备信息"}},[r("el-input",{model:{value:e.downForm.deviceInfo,callback:function(t){e.$set(e.downForm,"deviceInfo",t)},expression:"downForm.deviceInfo"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"固件信息",prop:""}},[r("el-input",{model:{value:e.downForm.firmwareInfo,callback:function(t){e.$set(e.downForm,"firmwareInfo",t)},expression:"downForm.firmwareInfo"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"备注",prop:""}},[r("el-input",{model:{value:e.downForm.comment,callback:function(t){e.$set(e.downForm,"comment",t)},expression:"downForm.comment"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.downdialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.downloadProduct}},[e._v("下 载")])],1)],1)],1)},staticRenderFns:[]};var c=r("VU/8")(i,l,!1,function(e){r("8ZFT")},"data-v-a7c9c3f8",null);t.default=c.exports}});
//# sourceMappingURL=13.d70aae9416fff7707bf3.js.map